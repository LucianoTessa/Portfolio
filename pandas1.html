<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Luciano Tessa - Portfolio</title>
    <link rel="stylesheet" href="styles_dashboards.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Afacad+Flux:wght@100..1000&family=Oswald:wght@200..700&display=swap"
        rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism-okaidia.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/components/prism-python.min.js"></script>
    <!-- Estilo para el resaltado -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">

    <!-- Script de highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

    <!-- Inicializar el resaltado -->
    <script>hljs.highlightAll();</script>
    <style>
        pre[class*="language-"] {
            border-radius: 10px;
            padding: 15px;
            overflow-x: auto;
            background: #2b2a2a;

        }
    </style>
</head>

<body class="dark">
    <header>
        <h1><a href="/">Portfolio</a></h1>
        <nav>
            <a class="cv" href="img/CVLucianoTessa.pdf" download="CVLucianoTessa.pdf">Descargar CV</a>
        </nav>
    </header>
    <main>
        <div class="text-container">
            <h1>Análisis de ventas de autos usados</h1>
            <div class="tecnologias-usadas">
                <div class="logo-item">
                    <img src="img/python-svgrepo-com.svg" />
                </div>
                <div class="logo-item pandas">
                    <img src="img/icons8-pandas.svg" />
                </div>
                <div class="logo-item matplotlib2">
                    <img src="img/matplotlib.png" />
                </div>
            </div>

            <h2>Objetivos</h2>
            <div class="objetivos">
                <p>
                    Limpiar datos nulos, descubrir y arreglar inconsistencias de precios, borrar tablas innecesarias y
                    dejar el dataset listo para su uso en Power BI.
                </p>
            </div>

            <h2>Carga, limpieza y modelado</h2>
            <div class="explicacion">

                <pre><code class="language-python">
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import kagglehub

# Descargar dataset desde Kaggle
path = kagglehub.dataset_download("austinreese/craigslist-carstrucks-data")
df = pd.read_csv(path + "/vehicles.csv")
                </code></pre>
                <p class="explicacion">
                    Importé las librerías principales que usé para análisis de los datos y su visualización.
                    <br><br>Utilicé pandas para la manipulación y análisis de datos y matplotlib.pyplot y seaborn para
                    crear gráficos y visualizaciones.
                    <br><br>Descargo el conjunto de datos directamente desde Kaggle usando la librería kagglehub.
                    <br><br>Cargo el archivo CSV del dataset en un DataFrame de pandas.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
nulls = df.isnull().sum().sort_values(ascending=False)
print(nulls)
                </code></pre>
                <p class="explicacion">
                    Sumo los valores nulos y los ordeno de mayor a menor para dentificar las columnas con estos valores
                    nulos y cuentar cuántos hay en cada una.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
nulls_percent = (df.isnull().sum() / len(df)) * 100
print(nulls_percent.sort_values(ascending=False))
                </code></pre>
                <p class="explicacion">
                    Calculé el porcentaje de datos faltantes por columna. Esto me permitió priorizar la limpieza de
                    las columnas con mayor porcentaje de nulos.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
df = df.drop(columns=["county", "size", "cylinders", "VIN", "drive"])
                </code></pre>
                <p class="explicacion">
                    Utilizando DROP eliminé las columnas que contenían más de 40% de datos nulos.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
df = df.fillna("unknown")
df = df[~df.isin(["unknown"]).any(axis=1)]
                </code></pre>
                <p class="explicacion">
                    Reemplazé los datos nulos restantes por "unknown". Se pueden hacer análisis con datos desconocidos
                    pero no con nulos.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
plt.figure(figsize=(15,7))
sns.countplot(data=df, x="manufacturer", order=df["manufacturer"].value_counts().index)
plt.xticks(rotation=60)
plt.title("Cantidad de autos por fabricante")
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/cantAutos.jpg" alt="" width="900" height="500">
                <p class="explicacion">
                    Con matplotlib y seaborn elaboré diferentes gráficos para detectar errores de manera más sencilla.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
plt.figure(figsize = (10,5))
sns.histplot(df["price"], bins=50, kde=True)
plt.title("Distribución de precios")
plt.xlabel("precio")
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/grafico-error.jpg" alt="" width="900" height="500">
                <p class="explicacion">
                    Al realizar este gráfico noté que el resultado no era normal. La alta escala daba a entender que en
                    el dataset habían precios estratosféricos los cuales había que borrar.
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
cantidad = df[df['price'] == 150000].shape[0]
print(cantidad)
                </code></pre>
                <pre><code class="language-python">
df.drop(df[df['price'] > 150000].index, inplace=True)
                </code></pre>
                <p class="explicacion">
                    Al ver que entre el rango de 140.000/150.000 solamente habían seis automóviles (primera imagen),
                    decidí borrar todas
                    las filas con precios mayores a 150.000. (segunda imagen)
                </p>
                <hr class="linea-fina">

                <pre><code class="language-python">
df_filtered = df[(df['price'] > 500) & (df['price'] < 150000)]
plt.figure(figsize = (10,5))
sns.histplot(df_filtered['price'], bins=50, kde=True)
plt.title("Distribución de precios")
plt.xlabel("Precio")
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/distribucion.jpg" alt="" width="900" height="500">
                <p class="explicacion">
                    Ahora tengo un gráfico de distribución de precios con buenas proporciones.
                </p>
                <hr class="linea-fina">
                <pre><code class="language-python">
plt.figure(figsize=(14,6))
sns.boxplot(data=df, x='manufacturer', y='price', showfliers=True)
plt.xticks(rotation=75)
plt.title('Distribución de precios por fabricante')
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/outliers.jpg" alt="">
                <p class="explicacion">
                    Creé un gráfico de cuartiles que abarca fabricantes y precios. La idea fue detectar outliers en los
                    precios más alejados de los cuartiles 1 y 3. En la imagen se pueden ver outliers en precios muy
                    bajos e irrealistas, en el rango de $0 a $3000.
                </p>
                <hr class="linea-fina">
                <pre><code class="language-python">
def eliminar_precios_bajos(grupo):
    limite_inferior = grupo['price'].quantile(0.05)
    return grupo[grupo['price'] >= limite_inferior]

df = df.groupby('manufacturer', group_keys=False).apply(eliminar_precios_bajos)

print(df)
                </code></pre>
                <p class="explicacion">
                    Los outliers por encima del tercer cuartil no son un problema, ya que demuestran precios altos para
                    determinados modelos de determinadas marcas, lo cual es totalmente normal y posible. Para
                    solucionar el problema los outliers de bajo monto los cuales seguramente sean errores, recurrí a
                    borrar el percentil 5 de cada fabricante.
                </p>
                <hr class="linea-fina">
                <pre><code class="language-python">
plt.figure(figsize=(14,6))
sns.boxplot(data=df, x='manufacturer', y='price')
plt.xticks(rotation=75)
plt.title('Distribución de precios por fabricante')
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/outliers-arreglado.jpg" alt="">
                <p class="explicacion">
                    Con el percentil 5 borrado en cada fabricante, el gráfico ahora tiene más sentido y me demuestra que
                    ya no hay precios extremadamente bajos los cuales suponían un error en el dataset.
                </p>
                <hr class="linea-fina">
                <pre><code class="language-python">
plt.figure(figsize=(10,6))
sns.scatterplot(data=df, x='year', y='price', alpha=0.5)
plt.title('Precio vs Año')
plt.show()
                </code></pre>
                <img src="img/imagenes-pandas/dispersión.jpg" alt="">
                <p class="explicacion">
                    Creé un gráfico de dispersión para ver si había valores fuera de escala, sea en precios como en años
                    pero a simple vista no se detecta ningún error que pueda suponer años o precios incoherentes.
                </p>
                <hr class="linea-fina">
                <p class="explicacion">
                    Luego del trabajo de limpieza, el dataset ya no cuenta datos nulos y columnas que no aportaban
                    valor.
                    Tampoco tiene precios irrealistas los cuales más adelante hubiesen generados errores al momento de
                    generar visualizaciones.
                </p>
                <p class="explicacion"> <br>
                    ✅ El dataset ya está listo para ser importado en un software de visualización de datos para poder
                    analizar más en detalle lo que sea requerido.</p>
                <p>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer">
            <p>&copy; 2024 Luciano Tessa</p>
        </div>
    </footer>
    <script src="scripts.js"></script>
</body>

</html>